<html>

<head>
    <link rel="stylesheet" href="style.css">

    <!-- Vue.js  -->
    <!-- Development version, includes helpful console warnings -->
    <!-- script src="https://cdn.jsdelivr.net/npm/vue/dist/vue.js"></script -->
    <!-- Production version, optimized for size and speed -->
    <script src="https://cdn.jsdelivr.net/npm/vue"></script>
</head>

<!-- Own library -->
<script type="module" src="bundle.js"></script>

<script src="main.js"></script>

<body onload="start()">
    <span id="app">
        <div id="header" class="padded flexrow">
            <span id="menu-left" class="flexrow padded">
                <img src="img/trust_logotype.svg" />
            </span>
            <span id="menu-right" class="padded">
                <span v-show="!userToken">
                    <button v-on:click="window.location.href = loginActionUrl()">Log in with GitHub</button>
                </span>
                <span v-show="userToken">
                    <button v-on:click="logout()">Logged in as {{loginName}}</button>
                </span>
            </span>
        </div>
        <div>
            <div id="loading" class="main" v-show="!initialized">
                <div class="mainheader">Loading...</div>
                <div class="center smallfont">
                    <div>user name: {{loginName ? loginName : "..."}}</div>
                    <div>repository: {{repo ? repo : repoSearchProgress}}</div>
                    <div>user token: {{userToken ? userToken : "..."}}</div>
                    <div>version: {{version ? version : "..."}}</div>
                </div>
            </div>
            <div v-show="initialized">
                <div id="main-ifnouser" class="main center" v-show="!userToken">
                    <div class="mainheader">Not logged in</div>
                    <div class="center">
                        You need to log in with your GitHub account, and authorize this application.
                    </div>
                </div>
                <div v-show="userToken">
                    <div id="main-ifusernorepo" class="main center" v-show="!repo">
                        <div class="mainheader">No fork found</div>
                        <div class="center">
                            <div>No forked repository found for user {{loginName}}</div>
                            <div>You need to fork the assets repository to be able create pull requests.</div>
                            <div>If you forked recently, try to <a v-bind:href="window.location">reload</a> after a few minutes.</div>
                            <div>
                                <button v-on:click="doCreateFork(userToken)">Fork '{{mainRepoName}}' Repo</button>
                            </div>
                            <div>To fork manually, go to the <a v-bind:href="mainRepoUrl" target="_blank">assets repository</a>, and press the Fork button</div>
                            <div>After completion, <a v-bind:href="window.location">reload</a> this page</div>
                            <div class="padded">
                                <img src="img/fork.png" width="600" border="1" />
                            </div>
                        </div>
                    </div>
                    <div class="main" v-show="repo">
                        <div id="menu-left" class="flexrow" v-show="maintainerMode">
                            <span class="tab-select selection-item" v-on:click="selectTab('tab-prs')"
                                v-bind:class="{'selected-item': activeTab == 'tab-prs'}">Pull Requests</span>
                            <span class="tab-select selection-item" v-on:click="selectTab('tab-search')"
                                v-bind:class="{'selected-item': activeTab == 'tab-search'}">Token Search</span>
                            <span class="tab-select selection-item" v-on:click="selectTab('tab-add')"
                                v-bind:class="{'selected-item': activeTab == 'tab-add'}">Add New Token</span>
                        </div>
                        <main-pulls id="tab-pulls" :user-token="userToken" :login-name="loginName" :repo="repo"
                            :enabled="maintainerMode" v-show="maintainerMode && activeTab == 'tab-prs'">
                        </main-pulls>
                        <main-token-search id="tab-search" :user-token="userToken" :login-name="loginName" :repo="repo"
                            v-show="maintainerMode && activeTab == 'tab-search'">
                        </main-token-search>
                        <main-add-token id="tab-add" :user-token="userToken" :login-name="loginName" :repo="repo"
                            v-show="activeTab == 'tab-add'">
                        </main-add-token>
                    </div>
                </div>
                <div hidden="true">
                    <img id="image-placeholder-for-size-computation" src="img/emptylogo.png" />
                </div>
            </div>
        </div>
        <div id="footer" class="padded">
            <span id="footer-left" class="padded">
            </span>
            <span id="footer-right" class="padded">
                <span v-show="maintainerMode">
                    <span id="version" class="smallfont">v{{version}}</span>
                </span>
                <!-- button v-show="userToken" v-on:click="toggleMaintainerMode">{{this.maintainerMode ? 'Contributor Mode' : 'Maintainer Mode'}}</button -->
            </span>
        </div>
    </span>
</body>

</html>